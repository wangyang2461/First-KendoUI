!function(r,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.KendoDataQuery=t():r.KendoDataQuery=t()}(this,function(){return function(r){function t(n){if(e[n])return e[n].exports;var i=e[n]={exports:{},id:n,loaded:!1};return r[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var e={};return t.m=r,t.c=e,t.p="",t(0)}([function(r,t,e){"use strict";var n=e(1);t.isCompositeFilterDescriptor=n.isCompositeFilterDescriptor;var i=e(3);t.toODataString=i.toODataString;var o=e(4);t.orderBy=o.orderBy,t.process=o.process;var u=e(6);t.expr=u.expr,t.getter=u.getter;var s=e(10);t.filterBy=s.filterBy,t.compileFilter=s.compileFilter;var c=e(7);t.groupBy=c.groupBy;var a=e(5);t.composeSortDescriptors=a.composeSortDescriptors;var f=e(10);t.filterExpr=f.filterExpr;var l=e(11);t.normalizeFilters=l.normalizeFilters;var p=e(7);t.normalizeGroups=p.normalizeGroups;var g=e(9);t.aggregateBy=g.aggregateBy},function(r,t,e){"use strict";var n=e(2);t.isCompositeFilterDescriptor=function(r){return n.isPresent(r.filters)}},function(r,t){"use strict";t.isPresent=function(r){return null!==r&&void 0!==r},t.isBlank=function(r){return null===r||void 0===r},t.isArray=function(r){return Array.isArray(r)},t.isFunction=function(r){return"function"==typeof r},t.isString=function(r){return"string"==typeof r},t.isTruthy=function(r){return!!r},t.isNullOrEmptyString=function(r){return t.isBlank(r)||0===r.trim().length},t.isNotNullOrEmptyString=function(r){return!t.isNullOrEmptyString(r)},t.isNumeric=function(r){return!isNaN(r-parseFloat(r))},t.isDate=function(r){return r&&r.getTime}},function(r,t,e){"use strict";var n=e(2),i=function(r){var t=r.filter(function(r){return n.isPresent(r.dir)}).map(function(r){var t=r.field.replace(/\./g,"/");return"desc"===r.dir?t+" desc":t}).join(",");return t?"$orderby="+t:t},o=function(r,t){return{skip:"$skip="+t.skip,sort:i(t.sort||[]),take:"$top="+t.take}[r]};t.toODataString=function(r){return Object.keys(r).map(function(t){return o(t,r)}).filter(n.isNotNullOrEmptyString).join("&")}},function(r,t,e){"use strict";var n=e(2),i=e(5),o=e(7),u=e(11),s=e(10),c=e(8);t.orderBy=function(r,t){r=r.slice(0);var e=i.composeSortDescriptors(t);return r.sort(e),r},t.count=function(r,t){for(var e=0,n=0,i=r.length;n<i;n++)t(r[n])&&e++;return e},t.limit=function(r,t){return t?r.filter(t):r},t.process=function(r,e){var i=e.skip,a=e.take,f=e.filter,l=e.sort,p=e.group,g=(l||[]).concat(o.normalizeGroups(p||[]));g.length&&(r=t.orderBy(r,g));var d=n.isPresent(f)&&c.filter.length,m=n.isPresent(p)&&p.length;if(!d&&!m)return{data:a?r.slice(i,i+a):r,total:r.length};var v,h,y=[];if(d?(h=s.compileFilter(u.normalizeFilters(f)),v=t.count(r,h),y.push(c.filter(h))):v=r.length,n.isPresent(i)&&n.isPresent(a)&&(y.push(c.skip(i)),y.push(c.take(a))),y.length){var x=c.compose.apply(void 0,y),_=m?o.groupBy(r,p,x,t.limit(r,h)):c.exec(x(c.concat),[],r);return{data:_,total:v}}return{data:m?o.groupBy(r,p):r,total:v}}},function(r,t,e){"use strict";var n=e(2),i=e(6),o=function(r,t){return n.isBlank(r)?r===t?0:-1:n.isBlank(t)?1:r.localeCompare?r.localeCompare(t):r>t?1:r<t?-1:0},u=function(r,t){return o(t,r)},s=function(r){var t=i.getter(r.field);return function(e,n){return("asc"===r.dir?o:u)(t(e),t(n))}},c=function(r,t){return 0};t.composeSortDescriptors=function(r){return r.filter(function(r){return n.isPresent(r.dir)}).map(function(r){return s(r)}).reduce(function(r,t){return function(e,n){return r(e,n)||t(e,n)}},c)}},function(r,t,e){"use strict";var n=e(2),i=["",""],o=function(r,t){return[r[0]+t[0],r[1]+t[1]]},u=function(r){return!n.isNullOrEmptyString(r)},s=function(r,t,e){var n="(",i=r.indexOf("[");return i===-1?r="."+r:i>0&&(n+="(",r="."+r.substring(0,i)+" || {})"+r.substring(i)),r+=t<e-1?" || {})":")",[n,r]},c=function(r,t){return r.filter(u).reduce(function(r,t,e,n){return o(r,s(t,e,n.length))},i).join(t)},a={};t.expr=function(r,t,e){return void 0===r&&(r=""),void 0===t&&(t=!1),void 0===e&&(e="d"),r&&"["!==r.charAt(0)&&(r="."+r),t?(r=r.replace(/"([^.]*)\.([^"]*)"/g,'"$1_$DOT$_$2"'),r=r.replace(/'([^.]*)\.([^']*)'/g,"'$1_$DOT$_$2'"),r=c(r.split("."),e),r=r.replace(/_\$DOT\$_/g,".")):r=e+r,r},t.getter=function(r,e){var n=r+e;return a[n]=a[n]||new Function("d","return "+t.expr(r,e))}},function(r,t,e){"use strict";var n=e(8),i=e(2),o=e(9),u=e(10);t.normalizeGroups=function(r){return r=i.isArray(r)?r:[r],r.map(function(r){return Object.assign({dir:"asc"},r)})};var s=n.map(function(r){return r});t.groupBy=function(r,e,c,a){if(void 0===e&&(e=[]),void 0===c&&(c=s),void 0===a&&(a=r),e=t.normalizeGroups(e),!e.length)return r;var f=e[0],l={},p=n.exec(c(n.groupCombinator(f.field)),l,r),g=[];return Object.keys(p).forEach(function(r){Object.keys(p[r]).forEach(function(n){var c=p[r][n],l={},d=a;i.isPresent(f.aggregates)&&(d=u.filterBy(a,{field:f.field,ignoreCase:!1,operator:"eq",value:c.value}),l=o.aggregateBy(d,f.aggregates)),g[c.__position]={aggregates:l,field:r,items:e.length>1?t.groupBy(c.items,e.slice(1),s,d):c.items,value:c.value}})}),g}},function(r,t,e){"use strict";var n=e(2),i=e(6);t.compose=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return function(t){return r.reduceRight(function(r,t){return t(r)},t)}};var o=function(r){return r=n.isPresent(r)&&r.getTime?r.getTime():r,r+""};t.groupCombinator=function(r){var t=i.getter(r,!0),e=0;return function(n,i){n[r]=n[r]||{};var u=t(i),s=o(u),c=n[r][s]||{__position:e++,aggregates:{},items:[],value:u};return c.items.push(i),n[r][s]=c,n}},t.expandAggregates=function(r){return void 0===r&&(r={}),Object.keys(r).forEach(function(t){var e=r[t];Object.keys(e).forEach(function(r){e[r]=e[r].result()})}),r};var u=function(r){return{average:function(){var r=0,t=0;return{calc:function(e){n.isNumeric(e)?(r+=e,t++):r=e},result:function(){return n.isNumeric(r)?r/t:r}}},count:function(){var r=0;return{calc:function(){return r++},result:function(){return r}}},max:function(){var r=Number.NEGATIVE_INFINITY;return{calc:function(t){r=n.isNumeric(r)||n.isDate(r)?r:t,r<t&&(n.isNumeric(t)||n.isDate(t))&&(r=t)},result:function(){return r}}},min:function(){var r=Number.POSITIVE_INFINITY;return{calc:function(t){r=n.isNumeric(r)||n.isDate(r)?r:t,r>t&&(n.isNumeric(t)||n.isDate(t))&&(r=t)},result:function(){return r}}},sum:function(){var r=0;return{calc:function(t){return r+=t},result:function(){return r}}}}[r]()};t.aggregatesCombinator=function(r){var t=r.map(function(r){var t=i.getter(r.field,!0),e=(r.aggregate||"").toLowerCase(),n=i.getter(e,!0);return function(i,o){var s=t(i)||{},c=n(s)||u(e);return c.calc(t(o)),s[r.aggregate]=c,i[r.field]=s,i}});return function(r,e){return t.reduce(function(r,t){return t(r,e)},r)}},t.concat=function(r,t){return r.push(t),r},t.map=function(r){return function(t){return function(e,n,i){return t(e,r(n,i))}}},t.filter=function(r){return function(t){return function(e,n){return r(n)?t(e,n):e}}},t.isTransformerResult=function(r){return n.isPresent(r.__value)};var s=function(r){return t.isTransformerResult(r)?r:{__value:r,reduced:!0}};t.take=function(r){return function(t){return function(e,n){return r-- >0?t(e,n):s(e)}}},t.takeWhile=function(r){return function(t){return function(e,n){return r(n)?t(e,n):s(e)}}},t.skip=function(r){return function(t){return function(e,n){return r--<=0?t(e,n):e}}},t.exec=function(r,e,n){for(var i=e,o=0,u=n.length;o<u;o++)if(i=r(i,n[o],o),t.isTransformerResult(i)){i=i.__value;break}return i}},function(r,t,e){"use strict";var n=e(8),i=n.map(function(r){return r});t.aggregateBy=function(r,t,e){void 0===t&&(t=[]),void 0===e&&(e=i);var o={};if(!t.length)return o;var u=n.exec(e(n.aggregatesCombinator(t)),o,r);return n.expandAggregates(u)}},function(r,t,e){"use strict";var n=e(6),i=e(2),o=e(1),u=e(11),s={and:" && ",or:" || "},c=function(r,t){if(i.isFunction(r)){var e="__f["+t.length+"](d)";return[e,t.concat([r])]}return[n.expr(r),t]},a=function(r,t,e){if(i.isFunction(r.operator)){var n="__o["+t.length+"]("+e+", "+u.operators.quote(r.value)+")";return[n,t.concat([r.operator])]}var o=!i.isPresent(r.ignoreCase)||r.ignoreCase;return[u.operators[r.operator||"eq"](e,r.value,o),t]},f=function(r,t,e,n){var i=c(r.field,n),o=i[0],u=i[1],s=a(r,e,o),f=s[0],l=s[1];return{expression:t.concat([f]),fields:u,operators:l}},l=function(){return{compositeFilterExpression:function(r,t,e,n){var i=l.filterExpr(r),o=i.expression.replace(/__o\[(\d+)\]/g,function(r,t){return"__o["+(e.length+ +t)+"]"}).replace(/__f\[(\d+)\]/g,function(r,t){return"__f["+(n.length+ +t)+"]"});return{expression:t.concat([o]),fields:n.concat(i.fields),operators:e.concat(i.operators)}},createExpression:function(r,t){return o.isCompositeFilterDescriptor(t)?l.compositeFilterExpression(t,r.expression,r.operators,r.fields):f(t,r.expression,r.operators,r.fields)},filterExpr:function(r){for(var t=r.filters,e={expression:[],fields:[],operators:[]},n=0,i=t.length;n<i;n++)e=l.createExpression(e,t[n]);return{expression:"("+e.expression.join(s[r.logic])+")",fields:e.fields,operators:e.operators}}}}();t.filterExpr=l.filterExpr,t.compileFilter=function(r){if(!r||0===r.filters.length)return function(){return!0};var e=t.filterExpr(r),n=new Function("d, __f, __o","return "+e.expression),i=e.fields.length||e.operators.length;return i?function(r){return n(r,e.fields,e.operators)}:n},t.filterBy=function(r,e){return!i.isPresent(e)||o.isCompositeFilterDescriptor(e)&&0===e.filters.length?r:r.filter(t.compileFilter(u.normalizeFilters(e)))}},function(r,t,e){"use strict";var n=e(2),i=e(1),o=/^\/Date\((.*?)\)\/$/,u=/(\r+|\n+)/g,s=/(?=['\\])/g,c=function(r){return{"!=":"neq","<":"lt","<=":"lte","==":"eq",">":"gt",">=":"gte",equal:"eq",equals:"eq",equalto:"eq",ge:"gte",greater:"gt",greaterthan:"gt",greaterthanequal:"gte",isempty:"isempty",isequalto:"eq",isgreaterthan:"gt",isgreaterthanorequalto:"gte",islessthan:"lt",islessthanorequalto:"lte",isnotempty:"isnotempty",isnotequalto:"neq",isnull:"isnull",le:"lte",less:"lt",lessthan:"lt",lessthanequal:"lte",ne:"neq",notequal:"neq",notequals:"neq",notequalto:"neq",notsubstringof:"doesnotcontain"}[r.toLowerCase()]||r},a=function(r){var t=r.filters||[];t.forEach(function(r){!i.isCompositeFilterDescriptor(r)&&n.isString(r.operator)&&(r.operator=c(r.operator)),i.isCompositeFilterDescriptor(r)&&a(r)})},f=function(r){return i.isCompositeFilterDescriptor(r)?r:{filters:n.isArray(r)?r:[r],logic:"and"}};t.normalizeFilters=function(r){return n.isPresent(r)&&(r=f(r),a(r)),r},t.operators=function(){var r=function(r){return r.replace(s,"\\").replace(u,"")},t=function(t,e,i,u){if(null!=i){if(n.isString(i)){i=r(i);var s=o.exec(i);s?i=new Date(+s[1]):u?(i="'"+i.toLowerCase()+"'",e="(("+e+" || '')+'').toLowerCase()"):i="'"+i+"'"}i.getTime&&(e="("+e+" && "+e+".getTime?"+e+".getTime():"+e+")",i=i.getTime())}return e+" "+t+" "+i},e=function(t,e,n,i){return i&&(e="("+e+" || '').toLowerCase()",n&&(n=n.toLowerCase())),n&&(n=r(n)),t(e,n)};return{contains:function(r,t,n){return e(function(r,t){return r+".indexOf('"+t+"') >= 0"},r,t,n)},doesnotcontain:function(r,t,n){return e(function(r,t){return r+".indexOf('"+t+"') == -1"},r,t,n)},doesnotendwith:function(r,t,n){return e(function(r,t){return r+".indexOf('"+t+"', "+r+".length - "+(t||"").length+") < 0"},r,t,n)},doesnotstartwith:function(r,t,n){return e(function(r,t){return r+".lastIndexOf('"+t+"', 0) == -1"},r,t,n)},endswith:function(r,t,n){return e(function(r,t){return r+".indexOf('"+t+"', "+r+".length - "+(t||"").length+") >= 0"},r,t,n)},eq:function(r,e,n){return t("==",r,e,n)},gt:function(r,e,n){return t(">",r,e,n)},gte:function(r,e,n){return t(">=",r,e,n)},isempty:function(r){return r+" === ''"},isnotempty:function(r){return r+" !== ''"},isnotnull:function(r){return"("+r+" !== null && "+r+" !== undefined)"},isnull:function(r){return"("+r+" === null || "+r+" === undefined)"},lt:function(r,e,n){return t("<",r,e,n)},lte:function(r,e,n){return t("<=",r,e,n)},neq:function(r,e,n){return t("!=",r,e,n)},quote:function(t){return t&&t.getTime?"new Date("+t.getTime()+")":n.isString(t)?"'"+r(t)+"'":""+t},startswith:function(r,t,n){return e(function(r,t){return r+".lastIndexOf('"+t+"', 0) == 0"},r,t,n)}}}()}])});